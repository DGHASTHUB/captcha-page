<!doctype html>

<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cyberpunk Notes ‚Äî Ghi ch√∫</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f14; --panel:#081018aa; --accent:#ff2d95; --accent2:#29f2ff; --glass:rgba(255,255,255,0.04);
      --neon-shadow: 0 0 12px rgba(255,45,149,0.18),0 0 40px rgba(41,242,255,0.06);
      --glass-border: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 10% 10%, rgba(41,242,255,0.04), transparent),
      radial-gradient(800px 400px at 90% 90%, rgba(255,45,149,0.03), transparent),var(--bg);color:#cfe9ff;font-family:Montserrat,system-ui,Arial}.app{display:grid;grid-template-columns:320px 1fr;gap:18px;padding:28px;min-height:100vh}

.sidebar{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:16px;padding:18px;backdrop-filter:blur(6px);box-shadow:var(--neon-shadow)}
.brand{display:flex;gap:12px;align-items:center;margin-bottom:12px}
.logo{width:46px;height:46px;border-radius:10px;background:conic-gradient(from 90deg, var(--accent), var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:700;color:#021;box-shadow:0 6px 18px rgba(41,242,255,0.06)}
h1{font-size:16px;margin:0}
.controls{display:flex;gap:8px;margin:12px 0}
button.btn{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:10px;color:inherit;cursor:pointer;font-weight:600}
button.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#021;border:none}
.search{margin-top:10px}
.search input{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.notes-list{margin-top:12px;max-height:60vh;overflow:auto;padding-right:8px}
.note-item{padding:10px;border-radius:8px;margin-bottom:8px;border:1px solid rgba(255,255,255,0.02);display:flex;flex-direction:column;gap:6px;cursor:pointer}
.note-item.active{box-shadow:0 6px 20px rgba(41,242,255,0.06);border-left:4px solid var(--accent)}
.note-title{font-weight:700}
.note-meta{font-size:12px;color:rgba(255,255,255,0.55)}
.tags{display:flex;gap:6px;flex-wrap:wrap}
.tag{font-size:11px;padding:4px 6px;border-radius:6px;background:rgba(255,255,255,0.02)}

.editor{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:18px;display:flex;flex-direction:column;gap:12px;backdrop-filter:blur(6px);box-shadow:var(--neon-shadow)}
.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
.title-input{font-size:20px;background:transparent;border:none;color:inherit;outline:none;font-weight:700}
.toolbar{display:flex;gap:8px;align-items:center}

.content{display:grid;grid-template-columns:1fr 420px;gap:14px;align-items:start}
.panel{background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.02);min-height:60vh}
textarea#editor{width:100%;height:100%;min-height:56vh;background:transparent;border:none;color:inherit;resize:none;outline:none;font-family:JetBrains Mono,monospace;font-size:14px}
.preview{overflow:auto;height:56vh;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:8px}

.footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;color:rgba(255,255,255,0.6)}

@media (max-width:900px){.app{grid-template-columns:1fr;padding:12px}.sidebar{display:none}.content{grid-template-columns:1fr}}

.neon{color:var(--accent);text-shadow:0 0 14px rgba(255,45,149,0.18)}

input[type=file]{display:none}

::-webkit-scrollbar{width:10px;height:10px}
::-webkit-scrollbar-thumb{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));border-radius:10px}

  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand"><div class="logo">CP</div><div><h1>CyberNotes</h1><div style="font-size:12px;color:rgba(255,255,255,0.5)">Ghi ch√∫ neon ‚Äî local only</div></div></div>
      <div class="controls">
        <button class="btn primary" id="newBtn">+ Ghi ch√∫ m·ªõi</button>
        <button class="btn" id="exportBtn">Export</button>
      </div>
      <div class="search"><input id="searchInput" placeholder="T√¨m ki·∫øm... (Ctrl+F)"/></div>
      <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" id="sortBtn">S·∫Øp x·∫øp: M·ªõi</button><button class="btn" id="clearBtn">X√≥a t·∫•t c·∫£</button></div>
      <div class="notes-list" id="notesList"></div>
      <input type="file" id="importFile" accept="application/json" />
    </aside><main class="editor">
  <div class="topbar">
    <input id="title" class="title-input" placeholder="Ti√™u ƒë·ªÅ..." />
    <div class="toolbar">
      <button class="btn" id="pinBtn">üîí</button>
      <button class="btn" id="deleteBtn">üóëÔ∏è</button>
      <button class="btn" id="importBtn">üìÇ</button>
      <button class="btn" id="exportTxtBtn">üìÑ</button>
      <button class="btn" id="shareBtn">üîó Chia s·∫ª</button>
      <button class="btn" id="togglePreview">üëÅÔ∏è</button>
    </div>
  </div>

  <div class="content">
    <div class="panel">
      <textarea id="editor" placeholder="Vi·∫øt ghi ch√∫... (h·ªó tr·ª£ markdown)"></textarea>
    </div>
    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong>Preview</strong><div class="tags" id="tagContainer"></div></div>
      <div class="preview" id="previewArea"></div>
    </div>
  </div>

  <div class="footer">
    <div id="status">ƒê√£ l∆∞u c·ª•c b·ªô</div>
    <div id="lastEdited"></div>
  </div>
</main>

  </div>  <script>
    const KEY='cyberpunk_notes_v1';
    let notes=JSON.parse(localStorage.getItem(KEY)||'[]');
    let activeId=null;
    let sortMode='new';
    const notesList=document.getElementById('notesList');
    const newBtn=document.getElementById('newBtn');
    const titleInput=document.getElementById('title');
    const editor=document.getElementById('editor');
    const status=document.getElementById('status');
    const previewArea=document.getElementById('previewArea');
    const togglePreviewBtn=document.getElementById('togglePreview');
    const searchInput=document.getElementById('searchInput');
    const deleteBtn=document.getElementById('deleteBtn');
    const exportBtn=document.getElementById('exportBtn');
    const importBtn=document.getElementById('importBtn');
    const importFile=document.getElementById('importFile');
    const exportTxtBtn=document.getElementById('exportTxtBtn');
    const pinBtn=document.getElementById('pinBtn');
    const tagContainer=document.getElementById('tagContainer');
    const sortBtn=document.getElementById('sortBtn');
    const clearBtn=document.getElementById('clearBtn');
    const lastEdited=document.getElementById('lastEdited');
    const shareBtn=document.getElementById('shareBtn');

    function uid(){return 'n_'+Math.random().toString(36).slice(2,9)}
    function nowISO(){return new Date().toISOString()}
    function save(){localStorage.setItem(KEY,JSON.stringify(notes));status.textContent='ƒê√£ l∆∞u '+new Date().toLocaleTimeString();renderList();}
    function load(){notes=JSON.parse(localStorage.getItem(KEY)||'[]');}

    function renderMarkdown(md){if(!md)return'';let out=md.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');out=out.replace(/^###### (.*$)/gim,'<h6>$1</h6>').replace(/^##### (.*$)/gim,'<h5>$1</h5>').replace(/^#### (.*$)/gim,'<h4>$1</h4>').replace(/^### (.*$)/gim,'<h3>$1</h3>').replace(/^## (.*$)/gim,'<h2>$1</h2>').replace(/^# (.*$)/gim,'<h1>$1</h1>').replace(/\*\*(.*?)\*\*/gim,'<strong>$1</strong>').replace(/\*(.*?)\*/gim,'<em>$1</em>').replace(/`([^`]+)`/gim,'<code>$1</code>').replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" target="_blank">$1</a>').replace(/^\s*-\s+(.*)/gim,'<li>$1</li>').replace(/(<li>.*<\/li>)/gim,'<ul>$1</ul>').replace(/\n\n+/gim,'</p><p>');out='<p>'+out+'</p>';out=out.replace(/```([\s\S]*?)```/gim,(m,c)=>'<pre><code>'+c+'</code></pre>');return out;}function renderList(){notesList.innerHTML='';let arr=[...notes];const q=searchInput.value.trim().toLowerCase();if(q)arr=arr.filter(n=>(n.title||'').toLowerCase().includes(q)||(n.content||'').toLowerCase().includes(q));if(sortMode==='new')arr.sort((a,b)=>new Date(b.updated)-new Date(a.updated));arr.forEach(n=>{const el=document.createElement('div');el.className='note-item'+(n.id===activeId?' active':'');el.innerHTML=`<div class='note-title'>${n.title||'Kh√¥ng ti√™u ƒë·ªÅ'}</div><div class='note-meta'>${new Date(n.updated).toLocaleString()}</div>`;el.onclick=()=>openNote(n.id);notesList.appendChild(el);});}

function openNote(id){const n=notes.find(x=>x.id===id);if(!n)return;activeId=id;titleInput.value=n.title;editor.value=n.content;renderPreview();renderTags(n.tags||[]);lastEdited.textContent='C·∫≠p nh·∫≠t: '+new Date(n.updated).toLocaleString();renderList();}
function createNote(){const n={id:uid(),title:'',content:'',created:nowISO(),updated:nowISO(),tags:[],pinned:false};notes.unshift(n);activeId=n.id;save();openNote(n.id);}
function updateActive(){if(!activeId)return;const n=notes.find(x=>x.id===activeId);if(!n)return;n.title=titleInput.value;n.content=editor.value;n.updated=nowISO();const tags=[...new Set((n.content.match(/#(\w+)/g)||[]).map(t=>t.slice(1)))];n.tags=tags;save();renderPreview();renderTags(n.tags||[]);}

function renderPreview(){previewArea.innerHTML=renderMarkdown(editor.value);}
function renderTags(tags){tagContainer.innerHTML='';tags.forEach(t=>{const el=document.createElement('div');el.className='tag';el.textContent='#'+t;tagContainer.appendChild(el)});}
function deleteActive(){if(!activeId)return;if(!confirm('X√≥a ghi ch√∫?'))return;notes=notes.filter(n=>n.id!==activeId);activeId=notes[0]?notes[0].id:null;save();if(activeId)openNote(activeId);else{titleInput.value='';editor.value='';previewArea.innerHTML='';renderTags([])}}

function exportJSON(){const data=JSON.stringify(notes,null,2);const blob=new Blob([data],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='cybernotes.json';a.click();URL.revokeObjectURL(url);}
function importJSONFile(file){const reader=new FileReader();reader.onload=e=>{try{const d=JSON.parse(e.target.result);if(!Array.isArray(d))throw 0;notes=d.concat(notes);save();alert('Import xong');}catch{alert('File l·ªói')}};reader.readAsText(file);}
function exportTxt(){if(!activeId)return alert('Ch·ªçn ghi ch√∫');const n=notes.find(x=>x.id===activeId);const blob=new Blob([(n.title+'\n\n'+n.content)],{type:'text/plain'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=(n.title||'note')+'.txt';a.click();URL.revokeObjectURL(url);}

// SHARE feature
function shareNote(){if(!activeId)return alert('Ch∆∞a ch·ªçn ghi ch√∫');const n=notes.find(x=>x.id===activeId);const data=btoa(unescape(encodeURIComponent(JSON.stringify({title:n.title,content:n.content}))));const shareUrl=location.origin+location.pathname+'#share='+data;navigator.clipboard.writeText(shareUrl).then(()=>alert('Link ƒë√£ sao ch√©p!'));}
function checkShared(){const hash=location.hash;if(hash.startsWith('#share=')){const data=hash.replace('#share=','');try{const json=JSON.parse(decodeURIComponent(escape(atob(data))));document.body.innerHTML='<div style="padding:40px;font-family:Montserrat;background:#0b0f14;color:#cfe9ff"><h1>'+json.title+'</h1><hr><div>'+renderMarkdown(json.content)+'</div><p style="margin-top:30px;color:#999">Ch·∫ø ƒë·ªô xem chia s·∫ª - ch·ªâ ƒë·ªçc</p></div>';}catch(e){alert('Link chia s·∫ª l·ªói');}}}

// Events
newBtn.onclick=createNote;editor.oninput=()=>{status.textContent='Ch∆∞a l∆∞u...';renderPreview();};titleInput.oninput=()=>status.textContent='Ch∆∞a l∆∞u...';let timer=null;[editor,titleInput].forEach(el=>el.addEventListener('input',()=>{clearTimeout(timer);timer=setTimeout(updateActive,1200);}));
togglePreviewBtn.onclick=()=>{previewArea.parentElement.style.display=previewArea.parentElement.style.display==='none'?'block':'block';renderPreview();}
searchInput.oninput=renderList;deleteBtn.onclick=deleteActive;exportBtn.onclick=exportJSON;importBtn.onclick=()=>importFile.click();importFile.onchange=e=>{if(e.target.files[0])importJSONFile(e.target.files[0]);};exportTxtBtn.onclick=